<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout/layout}">
<head>
    <meta charset="UTF-8">
    <title>내 매물 목록</title>
    <link rel="stylesheet" th:href="@{/resource/css/bootstrap.min.css}">
    <script th:inline="javascript">
        function confirmAction(actionUrl, message) {
            if (confirm(message)) {
                window.location.href = actionUrl;
            }
        }
    </script>
</head>
<body>
<div layout:fragment="content">
    <div class="container mt-5">
        <h2>내 매물 목록</h2>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>매물 ID</th>
                        <th>유형</th>
                        <th>주소</th>
                        <th>월세</th>
                        <th>보증금</th>
                        <th>상태</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="property : ${properties.content}">
                        <td th:text="${property.propertyId}"></td>
                        <td th:text="${property.propertyType}"></td>
                        <td th:text="${property.propertyAddress}"></td>
                        <td th:text="${property.monthlyRent}"></td>
                        <td th:text="${property.deposit}"></td>
                        <td th:text="${property.processingStatus}"></td>
                        <td>
                            <a th:href="@{/property/{id}(id=${property.propertyId})}" class="btn btn-primary btn-sm">보기</a>
                            <a th:href="@{/myProperty/update/{id}(id=${property.propertyId})}" class="btn btn-warning btn-sm">수정</a>
                             <a th:if="${property.processingStatus == '비활성화'}" 
                               href="javascript:void(0);" 
                               class="btn btn-success btn-sm" 
                               th:onclick="|confirmAction('@{/myProperty/activate/{id}(id=${property.propertyId})}', '승인요청을 하시겠습니까?')|">승인요청</a>

                            <a th:if="${property.processingStatus != '비활성화'}" 
                               href="javascript:void(0);" 
                               class="btn btn-danger btn-sm" 
                               th:onclick="|confirmAction('@{/myProperty/deactivate/{id}(id=${property.propertyId})}', '매물을 비활성화 하시겠습니까? 다시 활성화를 위해선 재승인이 필요합니다.')|">비활성화</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="pagination">
            <a th:href="@{/myPropertyList(page=${properties.number - 1}, size=${properties.size})}" th:if="${!properties.first}">&laquo;</a>
            <a th:each="pageNum : ${#numbers.sequence(1, properties.totalPages)}"
               th:href="@{/myPropertyList(page=${pageNum - 1}, size=${properties.size})}"
               th:text="${pageNum}"
               th:classappend="${pageNum == properties.number + 1} ? 'active'"></a>
            <a th:href="@{/myPropertyList(page=${properties.number + 1}, size=${properties.size})}" th:if="${!properties.last}">&raquo;</a>
        </div>
    </div>
</div>
</body>
</html>
